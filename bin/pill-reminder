#!/usr/bin/env node

var TelegramBot = require('node-telegram-bot-api');
var bot = new TelegramBot(process.env.TELEGRAM_BOT_TOKEN, {polling: true});

var mongoose = require('mongoose');
mongoose.connect(process.env.MONGOLAB_URI, function (error) {
    if (error) console.error(error);
    else console.log('mongo connected');
});

function pillReminder() {
  var ReminderTelegram = mongoose.model('ReminderTelegram', { chatId: String });

  ReminderTelegram.find({}, function(err, objs){
    objs.map(function(item){
        bot.sendMessage(item._doc.chatId, "Vai tomar o rem√©dio...");
    });
  });
}

pillReminder();
process.exit();